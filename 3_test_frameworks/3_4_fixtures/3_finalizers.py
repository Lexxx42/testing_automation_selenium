# Финализаторы — закрываем браузер

# Вероятно, вы заметили, что мы не использовали в этом примере команду browser.quit().
# Это привело к тому, что несколько окон браузера оставались открыты после окончания тестов,
# а закрылись только после завершения всех тестов.
# Закрытие браузеров произошло благодаря встроенной фикстуре — сборщику мусора.
# Но если бы количество тестов насчитывало больше нескольких десятков,
# то открытые окна браузеров могли привести к тому,
# что оперативная память закончилась бы очень быстро.
# Поэтому надо явно закрывать браузеры после каждого теста.
# Для этого мы можем воспользоваться финализаторами.

# Один из вариантов финализатора — использование ключевого слова Python: yield.
# После завершения теста, который вызывал фикстуру,
# выполнение фикстуры продолжится со строки, следующей за строкой со словом yield:

# test_fixture3.py

# Есть альтернативный способ вызова teardown кода
# с помощью встроенной фикстуры request и ее метода addfinalizer.
# Можете изучить его сами по документации PyTest.

# Рекомендуем также выносить очистку данных и памяти в фикстуру,
# вместо того чтобы писать это в шагах теста:
# финализатор выполнится даже в ситуации, когда тест упал с ошибкой.
